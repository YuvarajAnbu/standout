"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[29],{8029:function(e,i,t){t.r(i),t.d(i,{default:function(){return f}});var n=t(3433),a=t(9439),r=t(2791),c=t(7689),_=t(1087),s=t(1363),o=t(1243),l=t(9331),m=t(1413),d=t(4165),u=t(5861),g=t(1134),p=t(184);var v=function(e){var i=e.id,t=e.totalRatings,c=(e.setItem,(0,r.useContext)(l.St).user),_=(0,r.useContext)(l.$U),v=_.reviews,f=_.setReviews,x=(0,r.useContext)(l.Zv),h=x.userCount,w=x.setUserCount,j=(0,r.useContext)(l.t9),N=j.hideReviews,y=j.setHideReviews,b=(0,r.useContext)(l.Lp).orders,k=(0,r.useState)(!1),z=(0,a.Z)(k,2),Z=z[0],C=z[1],S=(0,r.useState)(!0),E=(0,a.Z)(S,2),R=E[0],I=E[1],T=(0,r.useState)(0),q=(0,a.Z)(T,2),G=q[0],U=q[1],H=(0,r.useState)([]),L=(0,a.Z)(H,2),F=L[0],P=L[1],A=(0,r.useState)({}),O=(0,a.Z)(A,2),V=O[0],$=O[1],B=(0,r.useState)(!1),D=(0,a.Z)(B,2),W=D[0],J=D[1],K=(0,r.useState)(""),M=(0,a.Z)(K,2),Q=M[0],X=M[1],Y=(0,r.useState)(""),ee=(0,a.Z)(Y,2),ie=ee[0],te=ee[1],ne=(0,r.useState)(!1),ae=(0,a.Z)(ne,2),re=ae[0],ce=ae[1],_e=(0,r.useState)(!1),se=(0,a.Z)(_e,2),oe=se[0],le=se[1];(0,r.useEffect)((function(){if(i<20){var e={reviews:[],reviewed:{},purchased:!1},t=e.reviews,n=e.reviewed,a=e.purchased;"undefined"!==typeof c.name?(v.forEach((function(e){e.productId===i&&e.email!==c.email&&t.push(e),e.productId===i&&e.email===c.email&&(N.includes(i+"&&&"+c.email)||(n=e))})),b.forEach((function(e){a||e.items.forEach((function(t){t._id===i&&e.customer.email===c.email&&(a=!0)}))}))):v.forEach((function(e){e.productId===i&&t.push(e)})),t.filter((function(e){return!N.includes(i+"&&&"+c.email)})),"undefined"===typeof n.email?$(void 0):(t=t.filter((function(e){return e.email!==c.email})),$(n)),P(t),J(a),U(1),I(!1)}else o.Z.get("/product/reviews?productId=".concat(i,"&page=",0,"&limit=").concat(12)).then((function(e){var t=e.data,n=t.reviews,a=t.reviewed,r=t.purchased;"undefined"!==typeof c.name?(v.forEach((function(e){e.productId===i&&e.email!==c.email&&n.push(e),e.productId===i&&e.email===c.email&&(a=[e])})),n.forEach((function(e,i){e.email===c.email&&n.splice(i,1)})),b.forEach((function(e){r||e.items.forEach((function(t){t._id===i&&e.customer.email===c.email&&(r=!0)}))}))):v.forEach((function(e){e.productId===i&&n.push(e)})),n.filter((function(e){return!N.includes(i+"&&&"+c.email)})),"undefined"!==typeof a?a.length<1?(P(n),$(void 0)):(n=n.filter((function(e){return e.email!==c.email})),P(n.filter((function(e){return e._id!==a[0]._id}))),N.includes(i+"&&&"+c.email)?$(void 0):$(a[0])):(P(n),$(void 0)),J(r),U(1),I(!1)})).catch((function(e){console.log(e)}))}),[i,b,c,v,N]),(0,r.useEffect)((function(){Z&&(document.getElementById("text-area").focus(),document.querySelector("textarea").style.height=document.querySelector("textarea").scrollHeight+"px")}),[Z]);var me=(0,r.useCallback)((function(){Z&&(document.querySelector("textarea").style.height=document.querySelector("textarea").scrollHeight+"px")}),[Z]);(0,r.useEffect)((function(){return window.addEventListener("resize",me),function(){return window.removeEventListener("resize",me)}}),[me]),(0,r.useEffect)((function(){if(""!==Q){var e=setTimeout((function(){X("")}),3400),i=setTimeout((function(){ce(!0)}),1),t=setTimeout((function(){ce(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(i),clearTimeout(t)}}}),[Q]),(0,r.useEffect)((function(){if(""!==ie){var e=setTimeout((function(){te("")}),3400),i=setTimeout((function(){ce(!0)}),1),t=setTimeout((function(){ce(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(i),clearTimeout(t)}}}),[ie]);var de=function(){var e=(0,u.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le(!0),o.Z.get("/product/reviews/?userId=".concat(c.name,"&productId=").concat(i,"&page=").concat(G,"&limit=").concat(12)).then((function(e){P("undefined"!==typeof V?function(i){return i.concat(e.data.reviews.filter((function(e){return e._id!==V._id})))}:function(i){return i.concat(e.data.reviews)}),U((function(e){return e+1})),le(!1)})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=(0,g.cI)(),ge=ue.register,pe=ue.handleSubmit,ve=ue.formState.errors;return(0,r.useEffect)((function(){"undefined"!==typeof ve.review&&X(ve.review.message)}),[ve]),R?(0,p.jsxs)("div",{className:"item-page__loading__container item-page__loading__container--reviews",children:[(0,p.jsx)("div",{className:"item-page__loading__container__title"}),(0,p.jsxs)("div",{className:"item-page__loading__container__flex",children:[(0,p.jsx)("div",{className:"item-page__loading__container__circle"}),(0,p.jsx)("div",{className:"item-page__loading__container__text"})]}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--ratings"}),(0,p.jsx)("div",{className:"item-page__loading__container__text"})]}):(0,p.jsxs)("div",{className:"item-page__reviews-container",children:[""!==Q&&(0,p.jsxs)("div",{className:re?"msg msg--visible":"msg",children:[(0,p.jsx)(s.G,{icon:["far","times-circle"],className:"icon",onClick:function(){te("")}}),(0,p.jsx)("p",{children:Q})]}),""!==ie&&(0,p.jsxs)("div",{className:re?"msg msg--visible":"msg",children:[(0,p.jsx)(s.G,{icon:["far","check-circle"],className:"icon",onClick:function(){te("")}}),(0,p.jsx)("p",{children:ie})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__title-container",children:[(0,p.jsx)("h1",{children:"reviews"}),!Z&&!R&&(0,p.jsx)("p",{onClick:function(){""===Q&&("undefined"!==typeof c.name?W?C(!0):X("you need to purchase the product first inorder or review about it"):X("login or signup to review about it"))},children:"undefined"!==typeof V?"Edit review":"Write a review"})]}),Z&&(0,p.jsx)("div",{className:"item-page__reviews-container__edit",children:(0,p.jsxs)("form",{onSubmit:pe((function(e){I(!0);var t={_id:h,productId:i,email:c.email,userName:c.name,rating:e.rating,review:e.review};f((function(e){return[].concat((0,n.Z)(e.filter((function(e){return t.email!==e.email}))),[t])})),w((function(e){return e+1})),U(0),I(!1),C(!1),te("review updated successfully")})),children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__edit__select",children:[(0,p.jsxs)("select",(0,m.Z)((0,m.Z)({name:"rating"},ge("rating")),{},{defaultValue:"undefined"!==typeof V?V.rating:"1",children:[(0,p.jsx)("option",{value:"1",children:"1"}),(0,p.jsx)("option",{value:"1.5",children:"1.5"}),(0,p.jsx)("option",{value:"2",children:"2"}),(0,p.jsx)("option",{value:"2.5",children:"2.5"}),(0,p.jsx)("option",{value:"3",children:"3"}),(0,p.jsx)("option",{value:"3.5",children:"3.5"}),(0,p.jsx)("option",{value:"4",children:"4"}),(0,p.jsx)("option",{value:"4.5",children:"4.5"}),(0,p.jsx)("option",{value:"5",children:"5"})]})),(0,p.jsx)(s.G,{className:"icon",icon:"chevron-right"})]}),(0,p.jsx)("textarea",(0,m.Z)((0,m.Z)({name:"review",id:"text-area",placeholder:"Type here...."},ge("review",{required:"reviews are required"})),{},{defaultValue:"undefined"!==typeof V?V.review:"",onInput:function(e){e.target.style.height=e.target.scrollHeight+"px"}})),(0,p.jsxs)("div",{className:"item-page__reviews-container__edit__button-container",children:[(0,p.jsx)("button",{type:"button",onClick:function(){C(!1)},children:"cancel"}),(0,p.jsx)("button",{className:"undefined"!==typeof ve.review?"item-page__reviews-container__edit__button-container--disabled":"",type:"submit",children:"add"})]})]})}),F.length<1&&"undefined"===typeof V?(0,p.jsx)("p",{className:"item-page__reviews-container__no-reviews",children:"This product is not yet rated."}):(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews",children:["undefined"!==typeof V&&(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review",children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__profile",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__profile__img",children:V.userName.slice(0,1)}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__profile__name",children:V.userName})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__rating-container",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__rating-container__icons",children:"".concat(V.rating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__rating-container__rating",children:"(".concat(V.rating,")")})]}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__desc",children:V.review}),(0,p.jsx)(s.G,{icon:"trash",className:"icon",onClick:function(){y((function(e){return[].concat((0,n.Z)(e),[i+"&&&"+c.email])})),$(void 0),te("your review had deleted successfully")}})]}),F.map((function(e,i){return(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review",children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__profile",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__profile__img",children:e.userName.slice(0,1)}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__profile__name",children:e.userName})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__rating-container",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__rating-container__icons",children:"".concat(e.rating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__rating-container__rating",children:"(".concat(e.rating,")")})]}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__desc",children:e.review})]},i)})),(0,p.jsxs)("p",{className:"item-page__reviews-container__reviews__count",children:[("undefined"!==typeof V?F.length+1:F.length)<t?"".concat("undefined"!==typeof V?F.length+1:F.length," / ").concat(t):"".concat(t,"/").concat(t)," ","reviews"]}),("undefined"!==typeof V?F.length+1:F.length)<t&&(0,p.jsx)("button",{className:oe?"item-page__reviews-container__reviews__load-more--loading":"item-page__reviews-container__reviews__load-more",type:"button",onClick:function(){oe||de()},children:oe?(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__load-more"}):"load more"})]})]})};var f=function(){var e=(0,c.s0)(),i=(0,r.useState)({}),t=(0,a.Z)(i,2),m=t[0],d=t[1],u=(0,r.useState)(0),g=(0,a.Z)(u,2),f=g[0],x=g[1],h=(0,r.useState)(0),w=(0,a.Z)(h,2),j=w[0],N=w[1],y=(0,r.useState)(1),b=(0,a.Z)(y,2),k=b[0],z=b[1],Z=(0,r.useState)(!1),C=(0,a.Z)(Z,2),S=C[0],E=C[1],R=(0,c.UO)().id,I=(0,r.useContext)(l.A9).setCart,T=(0,r.useContext)(l.ZP).userProducts,q=(0,r.useContext)(l.lg).hideProducts,G=(0,r.useContext)(l.s2);return(0,r.useEffect)((function(){var e;"undefined"!==typeof m._id&&(document.title="".concat((e=m.name,"".concat(e).replace(/(^\w|\s\w)(\S*)/g,(function(e,i,t){return i.toUpperCase()+t.toLowerCase()})))," | Stand Out"))}),[m]),(0,r.useEffect)((function(){if(S){var e=setTimeout((function(){E(!1)}),3e3);return function(){return clearTimeout(e)}}}),[S]),(0,r.useEffect)((function(){if(R.length<20||q.includes(R)){var i=T.filter((function(e){return e._id===R}));0===i.length?e("/404",{replace:!0}):d(i[0])}else o.Z.get("/product/".concat(R)).then((function(i){if(200!==i.status)throw new Error;"undefined"===typeof i.data.name?e("/404",{replace:!0}):d(i.data)})).catch((function(i){e("/404",{replace:!0}),console.log(i)}))}),[R,T,q,e]),(0,p.jsxs)("div",{className:"item-page",children:[(0,p.jsxs)("div",{className:S?"item-page__added item-page__added--visible":"item-page__added",children:[(0,p.jsx)("p",{children:"Added to Cart"}),(0,p.jsx)(_.rU,{to:"/checkout",children:(0,p.jsx)("button",{children:"go to cart"})})]}),"undefined"===typeof m._id?(0,p.jsxs)("div",{className:"item-page__loading__container item-page__loading__container--flexbox",children:[(0,p.jsx)("div",{className:"item-page__loading__container__img"}),(0,p.jsxs)("div",{className:"item-page__loading__container__content",children:[(0,p.jsx)("div",{className:"item-page__loading__container__text"}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--price"}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--ratings"}),(0,p.jsx)("div",{className:"item-page__loading__container__box"}),(0,p.jsx)("div",{className:"item-page__loading__container__box"}),(0,p.jsx)("div",{className:"item-page__loading__container__small-box"})]})]}):(0,p.jsxs)("div",{className:"item-page__item",children:[(0,p.jsx)("div",{className:"item-page__item__image",children:(0,p.jsx)("img",{src:G(500)+m.stock[f].images[0],alt:m.name,onError:function(e){e.target.src="/images/imgFailed.jpg"}})}),(0,p.jsxs)("form",{className:"item-page__item__content",onSubmit:function(e){e.preventDefault(),E(!0),I((function(e){var i=e.findIndex((function(e){return e._id===m._id&&e.size===m.stock[f].sizeRemaining[j].size&&e.color===m.stock[f].color}));if(-1===i)return[].concat((0,n.Z)(e),[{_id:m._id,image:m.stock[f].images[0],name:m.name,price:m.price,size:m.stock[f].sizeRemaining[j].size,color:m.stock[f].color,quantity:k}]);var t=(0,n.Z)(e);return t[i]={_id:m._id,image:m.stock[f].images[0],name:m.name,price:m.price,size:m.stock[f].sizeRemaining[j].size,color:m.stock[f].color,quantity:k+t[i].quantity},(0,n.Z)(t)}))},children:[(0,p.jsx)("p",{className:"item-page__item__content__name",children:m.name}),(0,p.jsx)("p",{className:"item-page__item__content__price",children:"$".concat((m.price/100).toFixed(2))}),m.averageRating&&(0,p.jsxs)("div",{className:"item-page__item__content__rating-container",children:[(0,p.jsx)("div",{className:"item-page__item__content__rating-container__icons",children:"".concat(m.averageRating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__item__content__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__item__content__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__item__content__rating-container__rating",children:m.averageRating.toFixed(1)}),(0,p.jsx)("p",{className:"item-page__item__content__rating-container__people",children:"(".concat(m.totalRatings,")")})]}),(0,p.jsxs)("div",{className:"item-page__item__content__color-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__color-container__label",children:"color :"}),(0,p.jsx)("div",{className:"item-page__item__content__color-container__colors",children:m.stock.map((function(e,i){return(0,p.jsx)("div",{className:f===i?"item-page__item__content__color-container__colors__color-box item-page__item__content__color-container__colors__color-box--active":"item-page__item__content__color-container__colors__color-box",onClick:function(){x(i),N(0)},children:(0,p.jsx)("div",{style:{backgroundColor:e.color},className:"item-page__item__content__color-container__colors__color-box__color"})},i)}))})]}),(0,p.jsxs)("div",{className:"item-page__item__content__size-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__size-container__label",children:"size :"}),(0,p.jsx)("div",{className:"item-page__item__content__size-container__sizes",children:m.stock[f].sizeRemaining.map((function(e,i){return(0,p.jsx)("p",{className:i===j?"item-page__item__content__size-container__sizes__size item-page__item__content__size-container__sizes__size--active":"item-page__item__content__size-container__sizes__size",onClick:function(){N(i)},children:e.size},i)}))}),m.stock[f].sizeRemaining[j].remaining<51&&(0,p.jsxs)("p",{className:"item-page__item__content__size-container__remaining",children:[m.stock[f].sizeRemaining[j].remaining," ","items left"]})]}),(0,p.jsxs)("div",{className:"item-page__item__content__quantity-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__quantity-container__label",children:"quantity :"}),(0,p.jsx)("input",{type:"number",value:k.toString(),min:1,max:m.stock[f].sizeRemaining[j].remaining,onChange:function(e){z(Number(e.target.value))}})]}),(0,p.jsx)("button",{className:"item-page__item__content__cart-button",style:k>0&&k<=m.stock[f].sizeRemaining[j].remaining?{}:{opacity:.7,cursor:"default"},type:"submit",children:"add to cart"})]})]}),(0,p.jsx)(v,{id:R,totalRatings:m.totalRatings,setItem:d})]})}}}]);
//# sourceMappingURL=29.d42efd38.chunk.js.map