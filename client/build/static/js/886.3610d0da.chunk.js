"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[886],{7886:function(e,n,o){o.r(n),o.d(n,{default:function(){return j}});var t=o(4165),i=o(2982),r=o(5861),s=o(4942),c=o(1413),a=o(885),l=o(2791),u=o(9271),d=o(4542),_=o(4569),m=o.n(_),p=(o(9842),o(8567)),f=o(1363),h=o(184);var x=function(e){var n=e.stockIndex,o=e.control,t=e.register,i=e.errors,r=e.getValues,s=e.item,c=(0,d.Dq)({control:o,name:"stock[".concat(n,"].sizeRemaining")}),a=c.fields,u=c.remove,_=c.append;return(0,l.useEffect)((function(){a.length<1&&("undefined"!==typeof s?s.sizeRemaining.forEach((function(e){setTimeout((function(){_({size:e.size,remaining:e.remaining},!1)}),1)})):_({size:""},!1))}),[_,a.length,s]),(0,h.jsx)("div",{children:a.map((function(e,o){return(0,h.jsxs)("div",{className:"upload__form__flex",children:[(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"stock[".concat(n,"].sizeRemaining[").concat(o,"].size"),children:["size ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsx)("input",{name:"stock[".concat(n,"].sizeRemaining[").concat(o,"].size"),className:"upload__form__input-container__size",placeholder:"XL or 8 or 7.5",ref:t({required:"required"}),defaultValue:e.size}),"undefined"!==typeof i.stock&&(0,h.jsx)("p",{className:"upload__form__input-container__error-msg",children:"undefined"!==typeof i.stock[n]&&"undefined"!==typeof i.stock[n].sizeRemaining&&"undefined"!==typeof i.stock[n].sizeRemaining[o]&&"undefined"!==typeof i.stock[n].sizeRemaining[o].size&&(0,h.jsxs)("span",{children:[(0,h.jsx)(f.G,{icon:"circle",className:"icon"})," ",i.stock[n].sizeRemaining[o].size.message]})})]}),(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"stock[".concat(n,"].sizeRemaining[").concat(o,"].remaining"),children:["remaining ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsx)("input",{name:"stock[".concat(n,"].sizeRemaining[").concat(o,"].remaining"),placeholder:"76",className:"upload__form__input-container__remaining",ref:t({pattern:{value:/^\d+$/,message:"Should be number"},required:"required"}),defaultValue:e.remaining}),"undefined"!==typeof i.stock&&(0,h.jsx)("p",{className:"upload__form__input-container__error-msg",children:"undefined"!==typeof i.stock[n]&&"undefined"!==typeof i.stock[n].sizeRemaining&&"undefined"!==typeof i.stock[n].sizeRemaining[o]&&"undefined"!==typeof i.stock[n].sizeRemaining[o].remaining&&(0,h.jsxs)("span",{children:[(0,h.jsx)(f.G,{icon:"circle",className:"icon"})," ",i.stock[n].sizeRemaining[o].remaining.message]})})]}),(0,h.jsxs)("div",{className:"upload__form__flex__button-container",children:[(0,h.jsx)("button",{type:"button",className:"upload__form__flex__button-container__remove-button",onClick:function(){r().stock[n].sizeRemaining.length>1&&u(o)},children:(0,h.jsx)(f.G,{icon:"minus"})}),(0,h.jsx)("button",{type:"button",className:"upload__form__flex__button-container__add-button",onClick:function(){return _({size:"",remaining:""})},children:(0,h.jsx)(f.G,{icon:"plus"})})]})]},e.id)}))})};var g=function(e){var n=e.control,o=e.register,t=e.errors,i=e.images,r=e.setImages,u=e.getValues,d=e.item,_=e.field,m=e.colors,p=e.setValue,g=e.index,j=e.append,v=e.remove,b=(0,l.useRef)(null),k=(0,l.useRef)(null),y=(0,l.useState)(m.filter((function(e){return e[1]===_.color}))[0]),N=(0,a.Z)(y,2),w=N[0],z=N[1],C=(0,l.useState)(!0),Z=(0,a.Z)(C,2),R=Z[0],O=Z[1],E=(0,l.useCallback)((function(e){O(!0)}),[]);return(0,l.useEffect)((function(){if(b.current)return window.addEventListener("click",E),function(){window.removeEventListener("click",E)}}),[b,E]),(0,l.useEffect)((function(){k&&(k.current.scrollTop="0")}),[R,k]),(0,h.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock",children:[(0,h.jsx)("input",{name:"stock[".concat(g,"]._id"),ref:o(),defaultValue:"string"===typeof _._id?_._id:_.id,type:"hidden"}),(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"stock[".concat(g,"].images"),children:["image ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone",onDrop:function(e){e.preventDefault();for(var n=function(n){var o=new FileReader;o.onload=function(e){r((function(e){var n="undefined"===typeof e[_._id]?[o.result]:e[_._id].concat(o.result);return(0,c.Z)((0,c.Z)({},e),{},(0,s.Z)({},_._id,n))}))},o.readAsDataURL(e.dataTransfer.files[n])},o=0;o<e.dataTransfer.files.length;o++)n(o)},onDragOver:function(e){e.preventDefault()},children:["undefined"===typeof i[_._id]||i[_._id].length<1?(0,h.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__upload-desc",children:[(0,h.jsx)(f.G,{className:"icon",icon:"cloud-upload-alt"}),(0,h.jsx)("p",{children:"Drag & drop or click to upload"})]}):(0,h.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container",children:[(0,h.jsx)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container__images",children:i[_._id].map((function(e,n){return(0,h.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container__images__image",children:[(0,h.jsx)("img",{src:e,alt:"product",onError:function(e){e.target.src="/images/imgFailed.jpg"}}),(0,h.jsx)("button",{type:"button",onClick:function(){r((function(n){return(0,c.Z)((0,c.Z)({},n),{},(0,s.Z)({},_._id,n[_._id].filter((function(n){return n!==e}))))}))},children:(0,h.jsx)(f.G,{icon:"times"})})]},n)}))}),(0,h.jsx)("p",{children:"Hover on image and click X to delete images"})]}),(0,h.jsx)("input",{type:"file",multiple:!0,onChange:function(e){for(var n=function(){var n=new FileReader;n.onload=function(e){r((function(e){var o="undefined"===typeof e[_._id]?[n.result]:e[_._id].concat(n.result);return(0,c.Z)((0,c.Z)({},e),{},(0,s.Z)({},_._id,o))}))},n.readAsDataURL(e.target.files[o])},o=0;o<e.target.files.length;o++)n()},name:"stock[".concat(g,"].images"),ref:o(),defaultValue:_.images})]})]}),(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"stock[".concat(g,"].color"),children:["color ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsxs)("div",{className:"upload__form__input-container__dropdown-container",ref:b,tabIndex:"0",onClick:function(e){e.stopPropagation(),O((function(e){return!e}))},children:[(0,h.jsxs)("div",{className:R?"upload__form__input-container__dropdown-container__box":"upload__form__input-container__dropdown-container__box upload__form__input-container__dropdown-container__box--active",children:[(0,h.jsx)("p",{children:w[0]}),(0,h.jsx)("div",{className:"upload__form__input-container__dropdown-container__color",style:{backgroundColor:w[1]}}),(0,h.jsx)(f.G,{icon:"chevron-right",className:"icon"})]}),(0,h.jsx)("div",{ref:k,className:R?"upload__form__input-container__dropdown-container__dropdown-options":"upload__form__input-container__dropdown-container__dropdown-options upload__form__input-container__dropdown-container__dropdown-options--visible",children:m.map((function(e,n){return(0,h.jsxs)("div",{style:{paddingRight:window.innerWidth-document.body.clientWidth===0?"40px":"23px"},className:w[0]===e[0]?"upload__form__input-container__dropdown-container__dropdown-options__box upload__form__input-container__dropdown-container__dropdown-options__box--active":"upload__form__input-container__dropdown-container__dropdown-options__box",onClick:function(){z(e),p("stock[".concat(g,"].color"),e[1]),b.current.scrollTop=0},children:[(0,h.jsx)("p",{children:e[0]}),(0,h.jsx)("div",{className:"upload__form__input-container__dropdown-container__color",style:{backgroundColor:e[1]}})]},n)}))}),(0,h.jsx)("input",{name:"stock[".concat(g,"].color"),type:"hidden",ref:o(),defaultValue:w[1]})]})]}),(0,h.jsx)("div",{children:(0,h.jsx)(x,{stockIndex:g,control:n,register:o,errors:t,getValues:u,item:d.stock[g]})}),(0,h.jsxs)("div",{className:"upload__form__button-container",children:[(0,h.jsx)("button",{type:"button",className:"upload__form__button-container__delete-button",onClick:function(){u().stock.length>1&&(v(g),r((function(e){return delete e[_.id],e})))},children:(0,h.jsx)(f.G,{icon:"trash"})}),(0,h.jsx)("button",{type:"button",className:"upload__form__button-container__add-button",onClick:function(){j({color:"",sizeRemaining:[{size:"",remaining:""}]})},children:(0,h.jsx)(f.G,{icon:"plus"})})]})]})};var j=function(){var e=(0,u.k6)(),n=(0,l.useState)({}),o=(0,a.Z)(n,2),_=o[0],x=o[1],j=(0,l.useContext)(p.ProductsContext).uploadOptions,v=(0,l.useContext)(p.UserContext).user,b=(0,l.useContext)(p.UserProductsContext),k=b.userProducts,y=b.setUserProducts,N=(0,l.useContext)(p.UserCountContext),w=N.userCount,z=N.setUserCount,C=(0,l.useContext)(p.HideProductsContext),Z=C.hideProducts,R=C.setHideProducts,O=(0,l.useContext)(p.ColorsContext),E=(0,l.useState)("women"),P=(0,a.Z)(E,2),T=P[0],S=P[1],V=(0,l.useState)({}),G=(0,a.Z)(V,2),D=G[0],F=G[1],q=(0,l.useState)(!1),U=(0,a.Z)(q,2),I=U[0],L=U[1],A=(0,u.UO)().id,H=(0,l.useState)(""),$=(0,a.Z)(H,2),W=$[0],X=$[1],M=(0,l.useState)(""),B=(0,a.Z)(M,2),J=B[0],K=B[1],Q=(0,l.useState)(!1),Y=(0,a.Z)(Q,2),ee=Y[0],ne=Y[1];(0,l.useEffect)((function(){document.title="Edit Products | Stand Out"}),[]),(0,l.useEffect)((function(){if(""!==J){var e=setTimeout((function(){K("")}),3400),n=setTimeout((function(){ne(!0)}),1),o=setTimeout((function(){ne(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(n),clearTimeout(o)}}}),[J]),(0,l.useEffect)((function(){if(""!==W){var e=setTimeout((function(){X("")}),3400),n=setTimeout((function(){ne(!0)}),1),o=setTimeout((function(){ne(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(n),clearTimeout(o)}}}),[W]),(0,l.useEffect)((function(){"undefined"!==typeof v.name?m().get("/user/is-admin").then((function(n){if(200!==n.status)throw new Error;"admin"!==n.data&&e.push(404)})).catch((function(n){console.log(n),e.push(404)})):e.replace("/404")}),[v.name,e]),(0,l.useEffect)((function(){if(A.length<20||Z.includes(A)){var n=k.filter((function(e){return e._id===A}));0===n.length?e.replace("/404"):x(n[0])}else m().get("/product/".concat(A)).then((function(n){if(200!==n.status)throw new Error;"undefined"===typeof n.data.name?e.replace("/404"):x(n.data)})).catch((function(n){e.replace("/404"),console.log(n)}))}),[A,k,Z,e]);var oe=(0,d.cI)(),te=oe.register,ie=oe.handleSubmit,re=oe.errors,se=oe.control,ce=oe.getValues,ae=oe.setValue,le=(0,d.Dq)({control:se,name:"stock"}),ue=le.fields,de=le.append,_e=le.remove;(0,l.useEffect)((function(){"undefined"!==typeof _._id&&ue.length<1&&_.stock.forEach((function(e){setTimeout((function(){F((function(n){return(0,c.Z)((0,c.Z)({},n),{},(0,s.Z)({},e._id,e.images))})),de({color:e.color,_id:e._id})}),1)}))}),[_,de,F,ue.length]);var me=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(n){var o,r,s,c,a,l;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L(!0),e.prev=1,o=Math.round(100*n.price),r=w,s="".concat((new Date).getTime()),c={_id:A,name:n.name,price:o,catagory:n.catagory,type:n.type,createdAt:s,stock:[]},a=Object.values(D),l=0;case 8:if(!(l<n.stock.length)){e.next=16;break}if("undefined"!==typeof a[l]){e.next=11;break}throw new Error;case 11:c.stock.push({_id:"".concat(r),images:a[l],color:n.stock[l].color,sizeRemaining:n.stock[l].sizeRemaining}),r+=1;case 13:l++,e.next=8;break;case 16:y((function(e){return[].concat((0,i.Z)(e.filter((function(e){return e._id!==A}))),[c])})),z(r+1),A.length>20&&R((function(e){return[].concat((0,i.Z)(e),[A])})),X("Product Updated Successfully"),L(!1),e.next=28;break;case 23:e.prev=23,e.t0=e.catch(1),console.log(e.t0),K("Something went wrong. Please try again"),L(!1);case 28:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(n){return e.apply(this,arguments)}}();return"undefined"===typeof _._id?(0,h.jsx)("div",{className:"loader-container",children:(0,h.jsx)("div",{className:"loader"})}):(0,h.jsxs)("div",{className:"upload",children:[""!==J&&(0,h.jsxs)("div",{className:ee?"msg msg--visible":"msg",children:[(0,h.jsx)(f.G,{icon:["far","times-circle"],className:"icon",onClick:function(){X("")}}),(0,h.jsx)("p",{children:J})]}),""!==W&&(0,h.jsxs)("div",{className:ee?"msg msg--visible":"msg",children:[(0,h.jsx)(f.G,{icon:["far","check-circle"],className:"icon",onClick:function(){X("")}}),(0,h.jsx)("p",{children:W})]}),(0,h.jsx)("h1",{children:"edit products"}),(0,h.jsxs)("form",{className:"upload__form",onSubmit:ie(me),children:[(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"name",children:["name ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsx)("input",{name:"name",autoFocus:!0,placeholder:"eg.  button down shirts for men",id:"inputName",ref:te({pattern:{value:/^[\w/d ]{0,}[\w-/d]{2,}[\w-/d ]{0,}$/,message:"should only be 2 or more than 2 letters"},required:"required"}),defaultValue:_.name}),"undefined"!==typeof re.name&&(0,h.jsxs)("p",{className:"upload__form__input-container__error-msg",children:[(0,h.jsx)(f.G,{icon:"circle",className:"icon"})," ",re.name.message]})]}),(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"price",children:["price ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsx)("input",{name:"price",placeholder:"25.55 or 25 (in usd)",ref:te({required:"required",pattern:{value:/^(\d+)(\.\d+)?$/,message:"should only contain number and may or may not one decimal"}}),defaultValue:_.price/100}),"undefined"!==typeof re.price&&(0,h.jsxs)("p",{className:"upload__form__input-container__error-msg",children:[(0,h.jsx)(f.G,{icon:"circle",className:"icon"})," ",re.price.message]})]}),(0,h.jsxs)("div",{className:"upload__form__flex",children:[(0,h.jsxs)("div",{className:"upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"catagory",children:["catagory ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsxs)("div",{className:"upload__form__input-container__select-container",children:[(0,h.jsxs)("select",{name:"catagory",onChange:function(e){return S(e.target.value)},ref:te,defaultValue:_.catagory,children:[(0,h.jsx)("option",{value:"women",children:"women"}),(0,h.jsx)("option",{value:"men",children:"men"}),(0,h.jsx)("option",{value:"both",children:"both"})]})," ",(0,h.jsx)(f.G,{icon:"chevron-right",className:"icon"})]})]}),(0,h.jsxs)("div",{className:" upload__form__input-container",children:[(0,h.jsxs)("label",{htmlFor:"type",children:["type ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsxs)("div",{className:"upload__form__input-container__select-container",children:[(0,h.jsx)("select",{name:"type",ref:te,defaultValue:_.type,children:j[T].map((function(e,n){return(0,h.jsx)("option",{value:e.toLowerCase(),children:e},n)}))})," ",(0,h.jsx)(f.G,{icon:"chevron-right",className:"icon"})]})]})]}),(0,h.jsxs)("div",{className:" upload__form__input-container upload__form__stocks-box",children:[(0,h.jsxs)("label",{htmlFor:"stock",children:["stock ",(0,h.jsx)("span",{children:"*"})]}),(0,h.jsx)("div",{className:"upload__form__stocks-box__stocks-container",children:ue.map((function(e,n){return(0,h.jsx)(g,{control:se,register:te,errors:re,images:D,setImages:F,getValues:ce,item:_,colors:O,setValue:ae,field:e,index:n,append:de,remove:_e},e.id)}))})]}),(0,h.jsx)("button",{className:I?"upload__form__submit-button upload__form__submit-button--loading":"upload__form__submit-button",type:"submit",children:I?(0,h.jsx)("div",{className:"upload__form__submit-button__loader"}):"upload"})]})]})}},9842:function(){},1413:function(e,n,o){o.d(n,{Z:function(){return r}});var t=o(4942);function i(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function r(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?i(Object(o),!0).forEach((function(n){(0,t.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}}}]);
//# sourceMappingURL=886.3610d0da.chunk.js.map