"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[29],{8029:function(e,i,t){t.r(i),t.d(i,{default:function(){return f}});var n=t(2982),a=t(885),r=t(2791),c=t(9271),_=t(1523),s=t(1363),o=t(4569),l=t.n(o),m=t(8567),d=t(4165),u=t(5861),g=t(4542),p=t(184);var v=function(e){var i=e.id,t=e.totalRatings,c=(e.setItem,(0,r.useContext)(m.UserContext).user),_=(0,r.useContext)(m.ReviewsContext),o=_.reviews,v=_.setReviews,f=(0,r.useContext)(m.UserCountContext),x=f.userCount,h=f.setUserCount,w=(0,r.useContext)(m.HideReviewsContent),j=w.hideReviews,N=w.setHideReviews,y=(0,r.useContext)(m.OrdersContext).orders,b=(0,r.useState)(!1),C=(0,a.Z)(b,2),k=C[0],z=C[1],E=(0,r.useState)(!0),Z=(0,a.Z)(E,2),S=Z[0],R=Z[1],I=(0,r.useState)(0),T=(0,a.Z)(I,2),q=T[0],G=T[1],H=(0,r.useState)([]),U=(0,a.Z)(H,2),P=U[0],F=U[1],O=(0,r.useState)({}),L=(0,a.Z)(O,2),V=L[0],A=L[1],B=(0,r.useState)(!1),W=(0,a.Z)(B,2),$=W[0],D=W[1],J=(0,r.useState)(""),K=(0,a.Z)(J,2),M=K[0],Q=K[1],X=(0,r.useState)(""),Y=(0,a.Z)(X,2),ee=Y[0],ie=Y[1],te=(0,r.useState)(!1),ne=(0,a.Z)(te,2),ae=ne[0],re=ne[1],ce=(0,r.useState)(!1),_e=(0,a.Z)(ce,2),se=_e[0],oe=_e[1];(0,r.useEffect)((function(){if(i<20){var e={reviews:[],reviewed:{},purchased:!1},t=e.reviews,n=e.reviewed,a=e.purchased;"undefined"!==typeof c.name?(o.forEach((function(e){e.productId===i&&e.email!==c.email&&t.push(e),e.productId===i&&e.email===c.email&&(j.includes(i+"&&&"+c.email)||(n=e))})),y.forEach((function(e){a||e.items.forEach((function(t){t._id===i&&e.customer.email===c.email&&(a=!0)}))}))):o.forEach((function(e){e.productId===i&&t.push(e)})),t.filter((function(e){return!j.includes(i+"&&&"+c.email)})),"undefined"===typeof n.email?A(void 0):(t=t.filter((function(e){return e.email!==c.email})),A(n)),F(t),D(a),G(1),R(!1)}else l().get("/product/reviews?productId=".concat(i,"&page=",0,"&limit=").concat(12)).then((function(e){var t=e.data,n=t.reviews,a=t.reviewed,r=t.purchased;"undefined"!==typeof c.name?(o.forEach((function(e){e.productId===i&&e.email!==c.email&&n.push(e),e.productId===i&&e.email===c.email&&(a=[e])})),n.forEach((function(e,i){e.email===c.email&&n.splice(i,1)})),y.forEach((function(e){r||e.items.forEach((function(t){t._id===i&&e.customer.email===c.email&&(r=!0)}))}))):o.forEach((function(e){e.productId===i&&n.push(e)})),n.filter((function(e){return!j.includes(i+"&&&"+c.email)})),"undefined"!==typeof a?a.length<1?(F(n),A(void 0)):(n=n.filter((function(e){return e.email!==c.email})),F(n.filter((function(e){return e._id!==a[0]._id}))),j.includes(i+"&&&"+c.email)?A(void 0):A(a[0])):(F(n),A(void 0)),D(r),G(1),R(!1)})).catch((function(e){console.log(e)}))}),[i,y,c,o,j]),(0,r.useEffect)((function(){k&&(document.getElementById("text-area").focus(),document.querySelector("textarea").style.height=document.querySelector("textarea").scrollHeight+"px")}),[k]);var le=(0,r.useCallback)((function(){k&&(document.querySelector("textarea").style.height=document.querySelector("textarea").scrollHeight+"px")}),[k]);(0,r.useEffect)((function(){return window.addEventListener("resize",le),function(){return window.removeEventListener("resize",le)}}),[le]),(0,r.useEffect)((function(){if(""!==M){var e=setTimeout((function(){Q("")}),3400),i=setTimeout((function(){re(!0)}),1),t=setTimeout((function(){re(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(i),clearTimeout(t)}}}),[M]),(0,r.useEffect)((function(){if(""!==ee){var e=setTimeout((function(){ie("")}),3400),i=setTimeout((function(){re(!0)}),1),t=setTimeout((function(){re(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(i),clearTimeout(t)}}}),[ee]);var me=function(){var e=(0,u.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:oe(!0),l().get("/product/reviews/?userId=".concat(c.name,"&productId=").concat(i,"&page=").concat(q,"&limit=").concat(12)).then((function(e){F("undefined"!==typeof V?function(i){return i.concat(e.data.reviews.filter((function(e){return e._id!==V._id})))}:function(i){return i.concat(e.data.reviews)}),G((function(e){return e+1})),oe(!1)})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=(0,g.cI)(),ue=de.register,ge=de.handleSubmit,pe=de.errors;return(0,r.useEffect)((function(){"undefined"!==typeof pe.review&&Q(pe.review.message)}),[pe]),S?(0,p.jsxs)("div",{className:"item-page__loading__container item-page__loading__container--reviews",children:[(0,p.jsx)("div",{className:"item-page__loading__container__title"}),(0,p.jsxs)("div",{className:"item-page__loading__container__flex",children:[(0,p.jsx)("div",{className:"item-page__loading__container__circle"}),(0,p.jsx)("div",{className:"item-page__loading__container__text"})]}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--ratings"}),(0,p.jsx)("div",{className:"item-page__loading__container__text"})]}):(0,p.jsxs)("div",{className:"item-page__reviews-container",children:[""!==M&&(0,p.jsxs)("div",{className:ae?"msg msg--visible":"msg",children:[(0,p.jsx)(s.G,{icon:["far","times-circle"],className:"icon",onClick:function(){ie("")}}),(0,p.jsx)("p",{children:M})]}),""!==ee&&(0,p.jsxs)("div",{className:ae?"msg msg--visible":"msg",children:[(0,p.jsx)(s.G,{icon:["far","check-circle"],className:"icon",onClick:function(){ie("")}}),(0,p.jsx)("p",{children:ee})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__title-container",children:[(0,p.jsx)("h1",{children:"reviews"}),!k&&!S&&(0,p.jsx)("p",{onClick:function(){""===M&&("undefined"!==typeof c.name?$?z(!0):Q("you need to purchase the product first inorder or review about it"):Q("login or signup to review about it"))},children:"undefined"!==typeof V?"Edit review":"Write a review"})]}),k&&(0,p.jsx)("div",{className:"item-page__reviews-container__edit",children:(0,p.jsxs)("form",{onSubmit:ge((function(e){R(!0);var t={_id:x,productId:i,email:c.email,userName:c.name,rating:e.rating,review:e.review};v((function(e){return[].concat((0,n.Z)(e.filter((function(e){return t.email!==e.email}))),[t])})),h((function(e){return e+1})),G(0),R(!1),z(!1),ie("review updated successfully")})),children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__edit__select",children:[(0,p.jsxs)("select",{name:"rating",ref:ue,defaultValue:"undefined"!==typeof V?V.rating:"1",children:[(0,p.jsx)("option",{value:"1",children:"1"}),(0,p.jsx)("option",{value:"1.5",children:"1.5"}),(0,p.jsx)("option",{value:"2",children:"2"}),(0,p.jsx)("option",{value:"2.5",children:"2.5"}),(0,p.jsx)("option",{value:"3",children:"3"}),(0,p.jsx)("option",{value:"3.5",children:"3.5"}),(0,p.jsx)("option",{value:"4",children:"4"}),(0,p.jsx)("option",{value:"4.5",children:"4.5"}),(0,p.jsx)("option",{value:"5",children:"5"})]}),(0,p.jsx)(s.G,{className:"icon",icon:"chevron-right"})]}),(0,p.jsx)("textarea",{name:"review",id:"text-area",placeholder:"Type here....",ref:ue({required:"reviews are required"}),defaultValue:"undefined"!==typeof V?V.review:"",onInput:function(e){e.target.style.height=e.target.scrollHeight+"px"}}),(0,p.jsxs)("div",{className:"item-page__reviews-container__edit__button-container",children:[(0,p.jsx)("button",{type:"button",onClick:function(){z(!1)},children:"cancel"}),(0,p.jsx)("button",{className:"undefined"!==typeof pe.review?"item-page__reviews-container__edit__button-container--disabled":"",type:"submit",children:"add"})]})]})}),P.length<1&&"undefined"===typeof V?(0,p.jsx)("p",{className:"item-page__reviews-container__no-reviews",children:"This product is not yet rated."}):(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews",children:["undefined"!==typeof V&&(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review",children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__profile",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__profile__img",children:V.userName.slice(0,1)}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__profile__name",children:V.userName})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__rating-container",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__rating-container__icons",children:"".concat(V.rating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__rating-container__rating",children:"(".concat(V.rating,")")})]}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__desc",children:V.review}),(0,p.jsx)(s.G,{icon:"trash",className:"icon",onClick:function(){N((function(e){return[].concat((0,n.Z)(e),[i+"&&&"+c.email])})),A(void 0),ie("your review had deleted successfully")}})]}),P.map((function(e,i){return(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review",children:[(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__profile",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__profile__img",children:e.userName.slice(0,1)}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__profile__name",children:e.userName})]}),(0,p.jsxs)("div",{className:"item-page__reviews-container__reviews__review__rating-container",children:[(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__review__rating-container__icons",children:"".concat(e.rating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__reviews-container__reviews__review__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__rating-container__rating",children:"(".concat(e.rating,")")})]}),(0,p.jsx)("p",{className:"item-page__reviews-container__reviews__review__desc",children:e.review})]},i)})),(0,p.jsxs)("p",{className:"item-page__reviews-container__reviews__count",children:[("undefined"!==typeof V?P.length+1:P.length)<t?"".concat("undefined"!==typeof V?P.length+1:P.length," / ").concat(t):"".concat(t,"/").concat(t)," ","reviews"]}),("undefined"!==typeof V?P.length+1:P.length)<t&&(0,p.jsx)("button",{className:se?"item-page__reviews-container__reviews__load-more--loading":"item-page__reviews-container__reviews__load-more",type:"button",onClick:function(){se||me()},children:se?(0,p.jsx)("div",{className:"item-page__reviews-container__reviews__load-more"}):"load more"})]})]})};var f=function(){var e=(0,c.k6)(),i=(0,r.useState)({}),t=(0,a.Z)(i,2),o=t[0],d=t[1],u=(0,r.useState)(0),g=(0,a.Z)(u,2),f=g[0],x=g[1],h=(0,r.useState)(0),w=(0,a.Z)(h,2),j=w[0],N=w[1],y=(0,r.useState)(1),b=(0,a.Z)(y,2),C=b[0],k=b[1],z=(0,r.useState)(!1),E=(0,a.Z)(z,2),Z=E[0],S=E[1],R=(0,c.UO)().id,I=(0,r.useContext)(m.CartContext).setCart,T=(0,r.useContext)(m.UserProductsContext).userProducts,q=(0,r.useContext)(m.HideProductsContext).hideProducts;return(0,r.useEffect)((function(){"undefined"!==typeof o._id&&(document.title="".concat(o.name," | Stand Out"))}),[o]),(0,r.useEffect)((function(){if(Z){var e=setTimeout((function(){S(!1)}),3e3);return function(){return clearTimeout(e)}}}),[Z]),(0,r.useEffect)((function(){if(R.length<20||q.includes(R)){var i=T.filter((function(e){return e._id===R}));0===i.length?e.replace("/404"):d(i[0])}else l().get("/product/".concat(R)).then((function(i){if(200!==i.status)throw new Error;"undefined"===typeof i.data.name?e.replace("/404"):d(i.data)})).catch((function(i){e.replace("/404"),console.log(i)}))}),[R,T,q,e]),(0,p.jsxs)("div",{className:"item-page",children:[(0,p.jsxs)("div",{className:Z?"item-page__added item-page__added--visible":"item-page__added",children:[(0,p.jsx)("p",{children:"Added to Cart"}),(0,p.jsx)(_.rU,{to:"/checkout",children:(0,p.jsx)("button",{children:"go to cart"})})]}),"undefined"===typeof o._id?(0,p.jsxs)("div",{className:"item-page__loading__container item-page__loading__container--flexbox",children:[(0,p.jsx)("div",{className:"item-page__loading__container__img"}),(0,p.jsxs)("div",{className:"item-page__loading__container__content",children:[(0,p.jsx)("div",{className:"item-page__loading__container__text"}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--price"}),(0,p.jsx)("div",{className:"item-page__loading__container__text item-page__loading__container__text--ratings"}),(0,p.jsx)("div",{className:"item-page__loading__container__box"}),(0,p.jsx)("div",{className:"item-page__loading__container__box"}),(0,p.jsx)("div",{className:"item-page__loading__container__small-box"})]})]}):(0,p.jsxs)("div",{className:"item-page__item",children:[(0,p.jsx)("div",{className:"item-page__item__image",children:(0,p.jsx)("img",{src:o.stock[f].images[0],alt:o.name,onError:function(e){e.target.src="/images/imgFailed.jpg"}})}),(0,p.jsxs)("div",{className:"item-page__item__content",children:[(0,p.jsx)("p",{className:"item-page__item__content__name",children:o.name}),(0,p.jsx)("p",{className:"item-page__item__content__price",children:"$".concat((o.price/100).toFixed(2))}),o.averageRating&&(0,p.jsxs)("div",{className:"item-page__item__content__rating-container",children:[(0,p.jsx)("div",{className:"item-page__item__content__rating-container__icons",children:"".concat(o.averageRating).split(".").map((function(e,i){if(0===i){for(var t=[],n=0;n<Number(e);n++)t.push((0,p.jsx)(s.G,{icon:"star",className:"item-page__item__content__rating-container__icons__icon"},n));return t}return(0,p.jsx)(s.G,{icon:"star-half",className:"item-page__item__content__rating-container__icons__icon"},9)}))}),(0,p.jsx)("p",{className:"item-page__item__content__rating-container__rating",children:o.averageRating.toFixed(1)}),(0,p.jsx)("p",{className:"item-page__item__content__rating-container__people",children:"(".concat(o.totalRatings,")")})]}),(0,p.jsxs)("div",{className:"item-page__item__content__color-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__color-container__label",children:"color :"}),(0,p.jsx)("div",{className:"item-page__item__content__color-container__colors",children:o.stock.map((function(e,i){return(0,p.jsx)("div",{className:f===i?"item-page__item__content__color-container__colors__color-box item-page__item__content__color-container__colors__color-box--active":"item-page__item__content__color-container__colors__color-box",onClick:function(){x(i),N(0)},children:(0,p.jsx)("div",{style:{backgroundColor:e.color},className:"item-page__item__content__color-container__colors__color-box__color"})},i)}))})]}),(0,p.jsxs)("div",{className:"item-page__item__content__size-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__size-container__label",children:"size :"}),(0,p.jsx)("div",{className:"item-page__item__content__size-container__sizes",children:o.stock[f].sizeRemaining.map((function(e,i){return(0,p.jsx)("p",{className:i===j?"item-page__item__content__size-container__sizes__size item-page__item__content__size-container__sizes__size--active":"item-page__item__content__size-container__sizes__size",onClick:function(){N(i)},children:e.size},i)}))}),o.stock[f].sizeRemaining[j].remaining<51&&(0,p.jsxs)("p",{className:"item-page__item__content__size-container__remaining",children:[o.stock[f].sizeRemaining[j].remaining," ","items left"]})]}),(0,p.jsxs)("div",{className:"item-page__item__content__quantity-container",children:[(0,p.jsx)("p",{className:"item-page__item__content__quantity-container__label",children:"quantity :"}),(0,p.jsx)("input",{type:"number",value:C,min:1,max:o.stock[f].sizeRemaining[j].remaining,onChange:function(e){k(Number(e.target.value))}})]}),(0,p.jsx)("button",{className:"item-page__item__content__cart-button",type:"button",onClick:function(){S(!0),I((function(e){var i=e.findIndex((function(e){return e._id===o._id&&e.size===o.stock[f].sizeRemaining[j].size&&e.color===o.stock[f].color}));if(-1===i)return[].concat((0,n.Z)(e),[{_id:o._id,image:o.stock[f].images[0],name:o.name,price:o.price,size:o.stock[f].sizeRemaining[j].size,color:o.stock[f].color,quantity:C}]);var t=(0,n.Z)(e);return t[i]={_id:o._id,image:o.stock[f].images[0],name:o.name,price:o.price,size:o.stock[f].sizeRemaining[j].size,color:o.stock[f].color,quantity:C+t[i].quantity},(0,n.Z)(t)}))},children:"add to cart"})]})]}),(0,p.jsx)(v,{id:R,totalRatings:o.totalRatings,setItem:d})]})}}}]);
//# sourceMappingURL=29.2fff552f.chunk.js.map