"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[886],{7886:function(e,n,o){o.r(n),o.d(n,{default:function(){return g}});var t=o(4165),i=o(3433),s=o(5861),a=o(4942),c=o(1413),r=o(9439),l=o(2791),d=o(7689),u=o(1134),_=o(1243),m=(o(9842),o(9331)),p=o(1363),f=o(184);var h=function(e){var n=e.stockIndex,o=e.control,t=e.register,i=e.errors,s=e.getValues,a=(0,u.Dq)({control:o,name:"stock[".concat(n,"].sizeRemaining")}),r=a.fields,l=a.remove,d=a.append;return(0,f.jsx)("div",{children:r.map((function(e,o){return(0,f.jsxs)("div",{className:"upload__form__flex",children:[(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"stock[".concat(n,"].sizeRemaining[").concat(o,"].size"),children:["size ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"stock[".concat(n,"].sizeRemaining[").concat(o,"].size"),className:"upload__form__input-container__size",placeholder:"XL or 8 or 7.5"},t("stock[".concat(n,"].sizeRemaining[").concat(o,"].size"),{required:"required"})),{},{defaultValue:e.size})),"undefined"!==typeof i.stock&&(0,f.jsx)("p",{className:"upload__form__input-container__error-msg",children:"undefined"!==typeof i.stock[n]&&"undefined"!==typeof i.stock[n].sizeRemaining&&"undefined"!==typeof i.stock[n].sizeRemaining[o]&&"undefined"!==typeof i.stock[n].sizeRemaining[o].size&&(0,f.jsxs)("span",{children:[(0,f.jsx)(p.G,{icon:"circle",className:"icon"})," ",i.stock[n].sizeRemaining[o].size.message]})})]}),(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"stock[".concat(n,"].sizeRemaining[").concat(o,"].remaining"),children:["remaining ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"stock[".concat(n,"].sizeRemaining[").concat(o,"].remaining"),placeholder:"76",className:"upload__form__input-container__remaining"},t("stock[".concat(n,"].sizeRemaining[").concat(o,"].remaining"),{pattern:{value:/^\d+$/,message:"Should be number"},required:"required"})),{},{defaultValue:e.remaining})),"undefined"!==typeof i.stock&&(0,f.jsx)("p",{className:"upload__form__input-container__error-msg",children:"undefined"!==typeof i.stock[n]&&"undefined"!==typeof i.stock[n].sizeRemaining&&"undefined"!==typeof i.stock[n].sizeRemaining[o]&&"undefined"!==typeof i.stock[n].sizeRemaining[o].remaining&&(0,f.jsxs)("span",{children:[(0,f.jsx)(p.G,{icon:"circle",className:"icon"})," ",i.stock[n].sizeRemaining[o].remaining.message]})})]}),(0,f.jsxs)("div",{className:"upload__form__flex__button-container",children:[(0,f.jsx)("button",{type:"button",className:"upload__form__flex__button-container__remove-button",onClick:function(){s().stock[n].sizeRemaining.length>1&&l(o)},children:(0,f.jsx)(p.G,{icon:"minus"})}),(0,f.jsx)("button",{type:"button",className:"upload__form__flex__button-container__add-button",onClick:function(){return d({size:"",remaining:""})},children:(0,f.jsx)(p.G,{icon:"plus"})})]})]},e.id)}))})};var x=function(e){var n=e.control,o=e.register,t=e.errors,i=e.images,s=e.setImages,d=e.getValues,u=e.item,_=e.field,x=e.colors,g=e.setValue,j=e.index,v=e.append,k=e.remove,b=(0,l.useContext)(m.s2),N=(0,l.useRef)(null),y=(0,l.useRef)(null),Z=(0,l.useState)(x.filter((function(e){return e[1]===_.color}))[0]),w=(0,r.Z)(Z,2),z=w[0],R=w[1],C=(0,l.useState)(!0),T=(0,r.Z)(C,2),S=T[0],V=T[1],E=(0,l.useCallback)((function(e){V(!0)}),[]);return(0,l.useEffect)((function(){if(N.current)return window.addEventListener("click",E),function(){window.removeEventListener("click",E)}}),[N,E]),(0,l.useEffect)((function(){y&&(y.current.scrollTop="0")}),[S,y]),(0,f.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock",children:[(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"stock[".concat(j,"]._id")},o("stock[".concat(j,"]._id"))),{},{defaultValue:"string"===typeof _._id?_._id:_.id,type:"hidden"})),(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"stock[".concat(j,"].images"),children:["image ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone",onDrop:function(e){e.preventDefault();for(var n=function(){var n=new FileReader;n.onload=function(e){s((function(e){var o="undefined"===typeof e[_._id]?[n.result]:e[_._id].concat(n.result);return(0,c.Z)((0,c.Z)({},e),{},(0,a.Z)({},_._id,o))}))},n.readAsDataURL(e.dataTransfer.files[o])},o=0;o<e.dataTransfer.files.length;o++)n()},onDragOver:function(e){e.preventDefault()},children:["undefined"===typeof i[_._id]||i[_._id].length<1?(0,f.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__upload-desc",children:[(0,f.jsx)(p.G,{className:"icon",icon:"cloud-upload-alt"}),(0,f.jsx)("p",{children:"Drag & drop or click to upload"})]}):(0,f.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container",children:[(0,f.jsx)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container__images",children:i[_._id].map((function(e,n){return(0,f.jsxs)("div",{className:"upload__form__stocks-box__stocks-container__stock__drop-zone__images-container__images__image",children:[(0,f.jsx)("img",{src:b(40)+e,alt:"product",onError:function(e){e.target.src="/images/imgFailed.jpg"}}),(0,f.jsx)("button",{type:"button",onClick:function(){s((function(n){return(0,c.Z)((0,c.Z)({},n),{},(0,a.Z)({},_._id,n[_._id].filter((function(n){return n!==e}))))}))},children:(0,f.jsx)(p.G,{icon:"times"})})]},n)}))}),(0,f.jsx)("p",{children:"Hover on image and click X to delete images"})]}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({type:"file",multiple:!0,onInput:function(e){for(var n=function(){var n=new FileReader;n.onload=function(e){s((function(e){var o="undefined"===typeof e[_._id]?[n.result]:e[_._id].concat(n.result);return(0,c.Z)((0,c.Z)({},e),{},(0,a.Z)({},_._id,o))}))},n.readAsDataURL(e.target.files[o])},o=0;o<e.target.files.length;o++)n()},onChange:function(e){for(var n=function(){var n=new FileReader;n.onload=function(e){s((function(e){var o="undefined"===typeof e[_._id]?[n.result]:e[_._id].concat(n.result);return(0,c.Z)((0,c.Z)({},e),{},(0,a.Z)({},_._id,o))}))},n.readAsDataURL(e.target.files[o])},o=0;o<e.target.files.length;o++)n()},name:"stock[".concat(j,"].images")},o("stock[".concat(j,"].images"))),{},{defaultValue:_.images}))]})]}),(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"stock[".concat(j,"].color"),children:["color ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsxs)("div",{className:"upload__form__input-container__dropdown-container",ref:N,tabIndex:"0",onClick:function(e){e.stopPropagation(),V((function(e){return!e}))},children:[(0,f.jsxs)("div",{className:S?"upload__form__input-container__dropdown-container__box":"upload__form__input-container__dropdown-container__box upload__form__input-container__dropdown-container__box--active",children:[(0,f.jsx)("p",{children:z[0]}),(0,f.jsx)("div",{className:"upload__form__input-container__dropdown-container__color",style:{backgroundColor:z[1]}}),(0,f.jsx)(p.G,{icon:"chevron-right",className:"icon"})]}),(0,f.jsx)("div",{ref:y,className:S?"upload__form__input-container__dropdown-container__dropdown-options":"upload__form__input-container__dropdown-container__dropdown-options upload__form__input-container__dropdown-container__dropdown-options--visible",children:x.map((function(e,n){return(0,f.jsxs)("div",{style:{paddingRight:window.innerWidth-document.body.clientWidth===0?"40px":"23px"},className:z[0]===e[0]?"upload__form__input-container__dropdown-container__dropdown-options__box upload__form__input-container__dropdown-container__dropdown-options__box--active":"upload__form__input-container__dropdown-container__dropdown-options__box",onClick:function(){R(e),g("stock[".concat(j,"].color"),e[1]),N.current.scrollTop=0},children:[(0,f.jsx)("p",{children:e[0]}),(0,f.jsx)("div",{className:"upload__form__input-container__dropdown-container__color",style:{backgroundColor:e[1]}})]},n)}))}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"stock[".concat(j,"].color"),type:"hidden"},o("stock[".concat(j,"].color"))),{},{defaultValue:z[1]}))]})]}),(0,f.jsx)("div",{children:(0,f.jsx)(h,{stockIndex:j,control:n,register:o,errors:t,getValues:d,item:u.stock[j]})}),(0,f.jsxs)("div",{className:"upload__form__button-container",children:[(0,f.jsx)("button",{type:"button",className:"upload__form__button-container__delete-button",onClick:function(){d().stock.length>1&&(k(j),s((function(e){return delete e[_.id],e})))},children:(0,f.jsx)(p.G,{icon:"trash"})}),(0,f.jsx)("button",{type:"button",className:"upload__form__button-container__add-button",onClick:function(){v({color:x[0][1],sizeRemaining:[{size:"",remaining:""}]})},children:(0,f.jsx)(p.G,{icon:"plus"})})]})]})};var g=function(){var e=(0,d.s0)(),n=(0,l.useState)({}),o=(0,r.Z)(n,2),h=o[0],g=o[1],j=(0,l.useContext)(m.BZ).uploadOptions,v=(0,l.useContext)(m.St).user,k=(0,l.useContext)(m.ZP),b=k.userProducts,N=k.setUserProducts,y=(0,l.useContext)(m.Zv),Z=y.userCount,w=y.setUserCount,z=(0,l.useContext)(m.lg),R=z.hideProducts,C=z.setHideProducts,T=(0,l.useContext)(m.eI),S=(0,l.useState)("women"),V=(0,r.Z)(S,2),E=V[0],G=V[1],F=(0,l.useState)({}),D=(0,r.Z)(F,2),q=D[0],P=D[1],I=(0,l.useState)(!1),L=(0,r.Z)(I,2),U=L[0],O=L[1],A=(0,d.UO)().id,$=(0,l.useState)(""),H=(0,r.Z)($,2),W=H[0],X=H[1],B=(0,l.useState)(""),M=(0,r.Z)(B,2),J=M[0],K=M[1],Q=(0,l.useState)(!1),Y=(0,r.Z)(Q,2),ee=Y[0],ne=Y[1];(0,l.useEffect)((function(){document.title="Edit Products | Stand Out"}),[]),(0,l.useEffect)((function(){if(""!==J){var e=setTimeout((function(){K("")}),3400),n=setTimeout((function(){ne(!0)}),1),o=setTimeout((function(){ne(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(n),clearTimeout(o)}}}),[J]),(0,l.useEffect)((function(){if(""!==W){var e=setTimeout((function(){X("")}),3400),n=setTimeout((function(){ne(!0)}),1),o=setTimeout((function(){ne(!1)}),3e3);return function(){clearTimeout(e),clearTimeout(n),clearTimeout(o)}}}),[W]),(0,l.useEffect)((function(){"undefined"!==typeof v.name?_.Z.get("/user/is-admin").then((function(n){if(200!==n.status)throw new Error;"admin"!==n.data&&e("/404")})).catch((function(n){console.log(n),e("/404")})):e("/404",{replace:!0})}),[v.name,e]),(0,l.useEffect)((function(){if(A.length<20||R.includes(A)){var n=b.filter((function(e){return e._id===A}));0===n.length?e("/404",{replace:!0}):g(n[0])}else _.Z.get("/product/".concat(A)).then((function(n){if(200!==n.status)throw new Error;"undefined"===typeof n.data.name?e("/404",{replace:!0}):g(n.data)})).catch((function(n){e("/404",{replace:!0}),console.log(n)}))}),[A,b,R,e]);var oe=(0,u.cI)(),te=oe.register,ie=oe.handleSubmit,se=oe.formState.errors,ae=oe.control,ce=oe.getValues,re=oe.setValue,le=(0,u.Dq)({control:ae,name:"stock"}),de=le.fields,ue=le.append,_e=le.remove;(0,l.useEffect)((function(){"undefined"!==typeof h._id&&de.length<1&&h.stock.forEach((function(e){setTimeout((function(){P((function(n){return(0,c.Z)((0,c.Z)({},n),{},(0,a.Z)({},e._id,e.images))})),ue({color:e.color,_id:e._id,sizeRemaining:e.sizeRemaining})}),1)}))}),[h,ue,de.length]);var me=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(n){var o,s,a,c,r,l;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0),e.prev=1,o=Math.round(100*n.price),s=Z,a="".concat((new Date).getTime()),c={_id:A,name:n.name,price:o,catagory:n.catagory,type:n.type,createdAt:a,stock:[]},r=Object.values(q),l=0;case 8:if(!(l<n.stock.length)){e.next=16;break}if("undefined"!==typeof r[l]){e.next=11;break}throw new Error;case 11:c.stock.push({_id:"".concat(s),images:r[l],color:n.stock[l].color,sizeRemaining:n.stock[l].sizeRemaining}),s+=1;case 13:l++,e.next=8;break;case 16:N((function(e){return[].concat((0,i.Z)(e.filter((function(e){return e._id!==A}))),[c])})),w(s+1),A.length>20&&C((function(e){return[].concat((0,i.Z)(e),[A])})),X("Product Updated Successfully"),O(!1),e.next=28;break;case 23:e.prev=23,e.t0=e.catch(1),console.log(e.t0),K("Something went wrong. Please try again"),O(!1);case 28:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(n){return e.apply(this,arguments)}}();return"undefined"===typeof h._id?(0,f.jsx)("div",{className:"loader-container",children:(0,f.jsx)("div",{className:"loader"})}):(0,f.jsxs)("div",{className:"upload",children:[""!==J&&(0,f.jsxs)("div",{className:ee?"msg msg--visible":"msg",children:[(0,f.jsx)(p.G,{icon:["far","times-circle"],className:"icon",onClick:function(){X("")}}),(0,f.jsx)("p",{children:J})]}),""!==W&&(0,f.jsxs)("div",{className:ee?"msg msg--visible":"msg",children:[(0,f.jsx)(p.G,{icon:["far","check-circle"],className:"icon",onClick:function(){X("")}}),(0,f.jsx)("p",{children:W})]}),(0,f.jsx)("h1",{children:"edit products"}),(0,f.jsxs)("form",{className:"upload__form",onSubmit:ie(me),children:[(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"name",children:["name ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"name",autoFocus:!0,placeholder:"eg.  button down shirts for men",id:"inputName"},te("inputName",{pattern:{value:/^[\w/d ]{0,}[\w-/d]{2,}[\w-/d ]{0,}$/,message:"should only be 2 or more than 2 letters"},required:"required"})),{},{defaultValue:h.name})),"undefined"!==typeof se.name&&(0,f.jsxs)("p",{className:"upload__form__input-container__error-msg",children:[(0,f.jsx)(p.G,{icon:"circle",className:"icon"})," ",se.name.message]})]}),(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"price",children:["price ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsx)("input",(0,c.Z)((0,c.Z)({name:"price",placeholder:"25.55 or 25 (in usd)"},te("price",{required:"required",pattern:{value:/^(\d+)(\.\d+)?$/,message:"should only contain number and may or may not one decimal"}})),{},{defaultValue:h.price/100})),"undefined"!==typeof se.price&&(0,f.jsxs)("p",{className:"upload__form__input-container__error-msg",children:[(0,f.jsx)(p.G,{icon:"circle",className:"icon"})," ",se.price.message]})]}),(0,f.jsxs)("div",{className:"upload__form__flex",children:[(0,f.jsxs)("div",{className:"upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"catagory",children:["catagory ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsxs)("div",{className:"upload__form__input-container__select-container",children:[(0,f.jsxs)("select",(0,c.Z)((0,c.Z)({name:"catagory",onChange:function(e){return G(e.target.value)}},te("catagory")),{},{defaultValue:h.catagory,children:[(0,f.jsx)("option",{value:"women",children:"women"}),(0,f.jsx)("option",{value:"men",children:"men"}),(0,f.jsx)("option",{value:"both",children:"both"})]}))," ",(0,f.jsx)(p.G,{icon:"chevron-right",className:"icon"})]})]}),(0,f.jsxs)("div",{className:" upload__form__input-container",children:[(0,f.jsxs)("label",{htmlFor:"type",children:["type ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsxs)("div",{className:"upload__form__input-container__select-container",children:[(0,f.jsx)("select",(0,c.Z)((0,c.Z)({name:"type"},te("type")),{},{defaultValue:h.type,children:j[E].map((function(e,n){return(0,f.jsx)("option",{value:e.toLowerCase(),children:e},n)}))}))," ",(0,f.jsx)(p.G,{icon:"chevron-right",className:"icon"})]})]})]}),(0,f.jsxs)("div",{className:" upload__form__input-container upload__form__stocks-box",children:[(0,f.jsxs)("label",{htmlFor:"stock",children:["stock ",(0,f.jsx)("span",{children:"*"})]}),(0,f.jsx)("div",{className:"upload__form__stocks-box__stocks-container",children:de.map((function(e,n){return(0,f.jsx)(x,{control:ae,register:te,errors:se,images:q,setImages:P,getValues:ce,item:h,colors:T,setValue:re,field:e,index:n,append:ue,remove:_e},e.id)}))})]}),(0,f.jsx)("button",{className:U?"upload__form__submit-button upload__form__submit-button--loading":"upload__form__submit-button",type:"submit",children:U?(0,f.jsx)("div",{className:"upload__form__submit-button__loader"}):"upload"})]})]})}},9842:function(){}}]);
//# sourceMappingURL=886.6f8bde82.chunk.js.map